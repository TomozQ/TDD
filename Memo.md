# TDDのサイクル
1. 小さいテストを1つ書く
2. 全てのテストを実行し、1つ失敗することを確認する。
3. 小さい変更を行う
4. 再びテストを実行し、すべて成功することを確認する
5. リファクタリングを行い、重複を除去する

## ここまでの振り返り
* 書くべきテストのリストを作った
* どうなったら嬉しいかを小さいテストコードで表現した
* PHPUnitの詳細については後回しにした
* 空実装を使って実行可能な状態にした
* 大罪を犯しながらテストを通した
* 動くコードをだんだんと共通化し、ベタ書きの値を変数に置き換えていった
* TODOリストに項目を追加するに留め、一度に多くのものを相手にすることを避けた

* 仮実装: コードをまずベタ書きの値を使い、実装を進めるに従って、徐々に変数に置き換えていく
* 明白な実装: すぐに頭の中の実装をコードに落とす

## ここまでの振り返り
* 設計の問題点（今回は副作用）をテストコードに写し取り、その問題点のせいでテストが失敗するのを確認した
* 空実装でさっさとコンパイルを通した
* 正しいと思える実装をすぐに行い、テストを通した。

## ここまでの振り返り
* Value Objectパターンを満たす条件がわかった
* その条件を満たすテストを書いた
* シンプルな実装を行なった
* すぐにリファクタリングを行うのではなく、もう1つテストを書いた
* 2つのテストを同時に通すリファクタリングを行なった。

## ここまでの振り返り
* 作成したばかりの機能を使って、テストを改善した
* そもそも正しく検証できていないテストが2つあったら、もはやお手上げだと気づいた
* そのようなリスクを受け入れて先に進んだ
* テスト対象オブジェクトの新しい機能を使い、テストコードとプロダクトコードの間の結合度を下げた

## ここまでの振り返り
* 大きいテストに立ち向かうにはまだ早かったので、次の一歩を進めるために小さなテストを捻り出した
* 恥知らずにも既存のテストをコピーアンドペーストして、テストを作成した
* さらに恥知らずにも、既存のモデルコードを丸ごとコピーペーストしてテストを通した
* この重複を排除するまでは家に帰らないと心に決めた

## ここまでの振り返り
* Dollarクラスから親クラスMoneyへ段階的にメソッドを移動した
* 2つ目のクラス（Franc）も同様にサブクラス化した
* 2つのequalsメソッドの差異をなくしてからサブクラス側の実装を削除した

## ここまでの振り返り
* 頭の中にある悩みをテストとして表現した
* 完璧ではないものの、まずまずのやり方（getClass）でテストを通した
* 更なる設計は、本当に必要になる時まで先延ばしにすることにした

## ここまでの振り返り
* 重複を除去できる状態に一歩近づけるために、DollarとFrancにある2つのtimesメソッドのシグネチャを合わせた
* せめてメソッド宣言だけは親クラスに移動した
* Factoryメソッドパターンを導入して、テストコードから2つのサブクラスの存在を隠した
* サブクラスを隠した結果、いくつかのテストが冗長なものになったことに気がついたが、今はそのままにしておいた

## ここまでの振り返り
* 大きめの設計変更にのめり込みそうになったので、その前に手前にある小さな変更に着手した
* 差異を呼び出し側（Franc Method側）に移動することによって、2つのサブクラスのコンストラクタを近づけていった
* リファクタリングの途中で少し寄り道して、timesメソッドの中でFactory Methodを使うように変更した
* Francに行なったリファクタリングをDollarにも同様に、今度は大きい歩幅で一気に適用した
* 完全に同じ内容になった2つのコンストラクタを親クラスに引き上げた

## ここまでの振り返り
* サブクラスたちのtimesメソッド実装の際をなくすために、まずはメソッド呼び出しをインライン化し、次にベタ書きの値を変数に置き換えた
* デバッグ用途のみに使うtoStringメソッドを、テストを書かずに実装した
* Francの代わりにMoneyを返す変更を試み、動くか動かないかはテストに聞いてみた
* 実験的な変更を巻き戻し、もう1つテストを書いた。再度テストを通るように実装することで、今度は実験を成功に導いた。

## ここまでの振り返り
* サブクラスの仕事を減らし続け、とうとう消すところまで辿り着いた
* サブクラス削除前の構造では意味があるものの、削除後は冗長になてしまうテストたちを削除した

## ここまでの振り返り
* 大きいテスト（$5 + 10CHF）を分割して、進み具合がわかる小さいテスト($5 + $5)を作成した
* これから行う計算のためのメタファーについて深く考えた
* 前章で書いたテストを、新しいメタファーを使って描き直した
* テストがコンパイルできるところまで早足で進んだ
* テストを通した
* 本当の実装を導いていくためのリファクタリングを楽しみにしつつ、少し不安も感じている

## ここまでの振り返り
* 重複を除去できていないので、TODOリストの項目を「済」にしなかった
* 実装の着想を得るためにさらに先に進むことにした
* のちに必要になりそうなオブジェクト（Sum）の作成を促すテストを書いた
* 速やかに実装を行なった（Sumのコンストラクタ）
* キャストを使って１カ所で実装した後で、テストが通るままで本来あるべき場所にコードをうつした
* ポリモフィズムを使って明示的なクラスチェックを置き換えた。

## JavaのHashMapぽいもの追加
https://localdisk.hatenablog.com/entry/20090611/1244730501